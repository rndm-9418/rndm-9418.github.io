$(function(){var NoticeCenter={list:{},overlay:function(id){if(!this.list[id]['eval']||this.list[id]['eval']=='')
MY_OVERLAY.active($('#tmpl-notice_overlayopen').tmpl(this.list[id]).html());else eval(this.list[id]['eval']);this.SetRodeNotice(id);this.closeList()},SetRodeNotice:function(id){$.post("/ajax.php",{module:'notice',act:'SetRodeNotice',id:id});$('#notice-'+id).removeClass('new');var cnt=$('.notice__center__item.new').length;$('#bell_counter').text(cnt);if(cnt==0){$('#notice_bell').removeClass('notice-has-new');$('#bell_counter').hide()}},closeList:function(){$('#notice_bell').removeClass('notice-list-open');$('#notice__center__list').fadeOut(300);$('body').unbind('click')}};$.post("/ajax.php",{module:'notice',dataType:'json',act:'getNoticeList',offset:0},function(data){var has_new=0,auto_open=!1;for(var i in data.response){var notice=data.response[i];NoticeCenter.list[notice.id]=notice;$('#notice__center__items').append($('#tmpl-notice_item').tmpl(notice));if(notice['new']==1){has_new++;if(notice.auto_open==1&&auto_open==!1){}}}
$('.notice__center__item:not(.binded)').on("click",function(){var id=$(this).data('id');if(!NoticeCenter.list[id].link)
NoticeCenter.overlay(id);else{NoticeCenter.SetRodeNotice(id);window.location.href=NoticeCenter.list[id].link}}).addClass('binded');if($('.notice__center__item.new').length>0){$('#bell_counter').text(has_new).show();$('.notice__center__item.new.auto-open:eq(0)').trigger('click');if(!$('#notice_bell').hasClass('notice-has-new')&&$('.notice__center__item.new').length>0){$('#notice_bell').addClass('notice-has-new');if(auto_open==!1)
AnimateIt('#notice_bell','shake');var enrol_inerval=setInterval(function(){var en=$('#notice_bell');if(typeof AnimateIt!='undefined'&&en.hasClass('notice-has-new')&&!en.hasClass('notice-list-open')){AnimateIt('#notice_bell','shake')}else clearInterval(enrol_inerval)},7000)}}},'json');$('#notice_bell').on('click',function(){if(!$(this).hasClass('notice-list-open')){$(this).addClass('notice-list-open');$('#notice__center__list').fadeIn(300,function(){$('body').bind('click',function(e){if($(e.target).parents('#notice__center__list').length==0){NoticeCenter.closeList()}})})}})})